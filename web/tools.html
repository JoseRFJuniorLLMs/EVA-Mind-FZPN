<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1600">
    <defs>
        <style>
            .actor {
                fill: #f9f;
                stroke: #333;
                stroke-width: 2;
            }

            .device {
                fill: #e3f2fd;
                stroke: #1976d2;
                stroke-width: 2;
            }

            .backend-box {
                fill: #fff3e0;
                stroke: #e65100;
                stroke-width: 2;
            }

            .backend-component {
                fill: #fff;
                stroke: #ff6f00;
                stroke-width: 1.5;
            }

            .model-x-box {
                fill: #e1f5fe;
                stroke: #01579b;
                stroke-width: 2;
            }

            .model-x {
                fill: #e1f5fe;
                stroke: #01579b;
                stroke-width: 2;
            }

            .model-y-box {
                fill: #fff3e0;
                stroke: #e65100;
                stroke-width: 2;
            }

            .model-y {
                fill: #fff3e0;
                stroke: #e65100;
                stroke-width: 2;
            }

            .infra-box {
                fill: #eceff1;
                stroke: #455a64;
                stroke-width: 2;
            }

            .infra-component {
                fill: #fff;
                stroke: #607d8b;
                stroke-width: 1.5;
            }

            .arrow-realtime {
                fill: none;
                stroke: #1976d2;
                stroke-width: 2.5;
                marker-end: url(#arrow-blue);
            }

            .arrow-bidirectional {
                fill: none;
                stroke: #1976d2;
                stroke-width: 2.5;
                marker-end: url(#arrow-blue);
                marker-start: url(#arrow-blue-start);
            }

            .arrow-tool {
                fill: none;
                stroke: #ff6f00;
                stroke-width: 2;
                stroke-dasharray: 5, 5;
                marker-end: url(#arrow-orange);
            }

            .arrow-data {
                fill: none;
                stroke: #388e3c;
                stroke-width: 2;
                marker-end: url(#arrow-green);
            }

            .arrow-analysis {
                fill: none;
                stroke: #7b1fa2;
                stroke-width: 2;
                marker-end: url(#arrow-purple);
            }

            text {
                font-family: 'Segoe UI', Arial, sans-serif;
                font-size: 13px;
            }

            .title {
                font-size: 18px;
                font-weight: bold;
            }

            .subtitle {
                font-size: 14px;
                font-weight: bold;
            }

            .label {
                font-size: 11px;
                fill: #333;
            }

            .label-small {
                font-size: 10px;
                fill: #555;
            }

            .emoji {
                font-size: 24px;
            }
        </style>

        <!-- Arrow markers -->
        <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <polygon points="0 0, 10 3, 0 6" fill="#1976d2" />
        </marker>
        <marker id="arrow-blue-start" markerWidth="10" markerHeight="10" refX="1" refY="3" orient="auto">
            <polygon points="10 0, 0 3, 10 6" fill="#1976d2" />
        </marker>
        <marker id="arrow-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <polygon points="0 0, 10 3, 0 6" fill="#ff6f00" />
        </marker>
        <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <polygon points="0 0, 10 3, 0 6" fill="#388e3c" />
        </marker>
        <marker id="arrow-purple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <polygon points="0 0, 10 3, 0 6" fill="#7b1fa2" />
        </marker>
    </defs>

    <!-- TITLE -->
    <text x="700" y="40" text-anchor="middle" class="title">Arquitetura EVA-Mind: Sistema Dual Gemini</text>

    <!-- IDOSO (Actor) -->
    <circle cx="120" cy="150" r="50" class="actor" />
    <text x="120" y="140" text-anchor="middle" class="emoji">üëµ</text>
    <text x="120" y="170" text-anchor="middle" font-weight="bold">Idoso</text>

    <!-- APP DEVICE -->
    <rect x="280" y="100" width="180" height="100" rx="10" class="device" />
    <text x="370" y="130" text-anchor="middle" class="emoji">üì±</text>
    <text x="370" y="160" text-anchor="middle" font-weight="bold">EVA Mobile</text>
    <text x="370" y="180" text-anchor="middle" class="label">/ Device</text>

    <!-- BACKEND GO BOX -->
    <rect x="550" y="80" width="320" height="280" rx="10" class="backend-box" />
    <text x="710" y="110" text-anchor="middle" class="subtitle">Backend EVA-Mind (Go)</text>

    <!-- Backend Components -->
    <rect x="580" y="130" width="260" height="60" rx="5" class="backend-component" />
    <text x="710" y="155" text-anchor="middle" font-weight="bold">Generic Client</text>
    <text x="710" y="175" text-anchor="middle" class="label-small">(client.go)</text>

    <rect x="580" y="210" width="260" height="60" rx="5" class="backend-component" />
    <text x="710" y="235" text-anchor="middle" font-weight="bold">Tool Executor</text>
    <text x="710" y="255" text-anchor="middle" class="label-small">(tools.go)</text>

    <rect x="580" y="290" width="260" height="60" rx="5" class="backend-component" />
    <text x="710" y="315" text-anchor="middle" font-weight="bold">Health Analyzer</text>
    <text x="710" y="335" text-anchor="middle" class="label-small">(analysis.go)</text>

    <!-- MODEL X BOX -->
    <rect x="950" y="80" width="380" height="180" rx="10" class="model-x-box" />
    <text x="1140" y="110" text-anchor="middle" class="subtitle">üó£Ô∏è Modelo X: Conversacional</text>

    <rect x="980" y="130" width="320" height="110" rx="5" class="model-x" />
    <text x="1140" y="165" text-anchor="middle" font-weight="bold" font-size="15">Gemini Live API</text>
    <text x="1140" y="190" text-anchor="middle" class="label">(Multimodal Audio/Voice)</text>
    <text x="1140" y="210" text-anchor="middle" class="label-small">Stream Bidirecional</text>
    <text x="1140" y="225" text-anchor="middle" class="label-small">Voz "Aoede" - PCM 24kHz</text>

    <!-- MODEL Y BOX -->
    <rect x="950" y="300" width="380" height="180" rx="10" class="model-y-box" />
    <text x="1140" y="330" text-anchor="middle" class="subtitle">üß† Modelo Y: Anal√≠tico</text>

    <rect x="980" y="350" width="320" height="110" rx="5" class="model-y" />
    <text x="1140" y="385" text-anchor="middle" font-weight="bold" font-size="15">Gemini 2.5 Flash</text>
    <text x="1140" y="410" text-anchor="middle" class="label">(Text-to-JSON)</text>
    <text x="1140" y="430" text-anchor="middle" class="label-small">An√°lise M√©dica Estruturada</text>
    <text x="1140" y="445" text-anchor="middle" class="label-small">N√£o interage com o idoso</text>

    <!-- INFRASTRUCTURE BOX -->
    <rect x="100" y="550" width="500" height="200" rx="10" class="infra-box" />
    <text x="350" y="580" text-anchor="middle" class="subtitle">Infraestrutura</text>

    <!-- PostgreSQL -->
    <ellipse cx="250" cy="660" rx="100" ry="70" class="infra-component" />
    <text x="250" y="655" text-anchor="middle" font-weight="bold" font-size="15">PostgreSQL</text>
    <text x="250" y="675" text-anchor="middle" class="label-small">Agendamentos</text>
    <text x="250" y="690" text-anchor="middle" class="label-small">Hist√≥rico</text>
    <text x="250" y="705" text-anchor="middle" class="label-small">Relat√≥rios</text>

    <!-- FCM -->
    <rect x="400" y="610" width="150" height="100" rx="5" class="infra-component" />
    <text x="475" y="640" text-anchor="middle" font-weight="bold" font-size="14">Firebase</text>
    <text x="475" y="660" text-anchor="middle" font-weight="bold" font-size="14">Cloud</text>
    <text x="475" y="680" text-anchor="middle" font-weight="bold" font-size="14">Messaging</text>
    <text x="475" y="700" text-anchor="middle" class="label-small">(Push Notifications)</text>

    <!-- ARROWS - Real-time Audio Flow -->
    <path d="M 170 150 L 280 150" class="arrow-bidirectional" />
    <text x="225" y="140" text-anchor="middle" class="label-small">√Åudio PCM</text>
    <text x="225" y="170" text-anchor="middle" class="label-small">16 kHz</text>

    <path d="M 460 150 L 580 160" class="arrow-bidirectional" />
    <text x="520" y="140" text-anchor="middle" class="label-small">WebSocket</text>
    <text x="520" y="155" text-anchor="middle" class="label-small">Segura (WSS)</text>

    <path d="M 840 160 L 980 180" class="arrow-bidirectional" />
    <text x="910" y="150" text-anchor="middle" class="label-small">Stream Bidirecional</text>
    <text x="910" y="165" text-anchor="middle" class="label-small">(√Åudio + Tools)</text>

    <!-- ARROWS - Tool Execution Flow -->
    <path d="M 980 200 L 840 230" class="arrow-tool" />
    <text x="910" y="210" text-anchor="middle" class="label-small" fill="#ff6f00">Tool Call Request</text>
    <text x="910" y="225" text-anchor="middle" class="label-small" fill="#ff6f00">Ex: alert_family</text>

    <path d="M 710 190 L 710 210" class="arrow-tool" />
    <text x="780" y="205" text-anchor="middle" class="label-small" fill="#ff6f00">Executa</text>

    <!-- Tool to DB -->
    <path d="M 630 270 L 300 590" class="arrow-data" />
    <text x="450" y="420" text-anchor="middle" class="label-small" fill="#388e3c">SQL Insert/</text>
    <text x="450" y="435" text-anchor="middle" class="label-small" fill="#388e3c">Update</text>

    <!-- Tool to FCM -->
    <path d="M 730 270 L 475 610" class="arrow-data" />
    <text x="620" y="420" text-anchor="middle" class="label-small" fill="#388e3c">Push</text>
    <text x="620" y="435" text-anchor="middle" class="label-small" fill="#388e3c">Notification</text>

    <!-- Tool Response back -->
    <path d="M 710 210 L 710 190" class="arrow-tool" />
    <text x="650" y="205" text-anchor="middle" class="label-small" fill="#ff6f00">Tool Response</text>

    <path d="M 840 230 L 980 200" class="arrow-tool" />
    <text x="910" y="250" text-anchor="middle" class="label-small" fill="#ff6f00">Tool Result</text>

    <!-- ARROWS - Analysis Flow -->
    <path d="M 710 190 L 710 290" class="arrow-analysis" />
    <text x="780" y="240" text-anchor="middle" class="label-small" fill="#7b1fa2">Transcri√ß√£o</text>
    <text x="780" y="255" text-anchor="middle" class="label-small" fill="#7b1fa2">Acumulada</text>

    <path d="M 840 410 L 980 410" class="arrow-analysis" />
    <text x="910" y="395" text-anchor="middle" class="label-small" fill="#7b1fa2">HTTP REST POST</text>
    <text x="910" y="430" text-anchor="middle" class="label-small" fill="#7b1fa2">Prompt M√©dico</text>

    <path d="M 980 410 L 840 410" class="arrow-analysis" />
    <text x="910" y="450" text-anchor="middle" class="label-small" fill="#7b1fa2">JSON Estruturado</text>
    <text x="910" y="465" text-anchor="middle" class="label-small" fill="#7b1fa2">(Sa√∫de, Humor, Urg√™ncia)</text>

    <path d="M 630 350 L 300 590" class="arrow-analysis" />
    <text x="450" y="480" text-anchor="middle" class="label-small" fill="#7b1fa2">Salva</text>
    <text x="450" y="495" text-anchor="middle" class="label-small" fill="#7b1fa2">Relat√≥rio</text>

    <!-- LEGEND BOX -->
    <rect x="700" y="550" width="650" height="320" rx="10" fill="#fafafa" stroke="#333" stroke-width="2" />
    <text x="1025" y="585" text-anchor="middle" class="title" font-size="16">Legenda T√©cnica</text>

    <!-- Model X Legend -->
    <rect x="730" y="610" width="280" height="110" rx="5" fill="#e1f5fe" stroke="#01579b" stroke-width="1.5" />
    <text x="870" y="635" text-anchor="middle" font-weight="bold" fill="#01579b">Modelo X - Conversacional</text>
    <text x="870" y="655" text-anchor="middle" class="label-small">‚Ä¢ WebSocket (wss://...BidiGenerateContent)</text>
    <text x="870" y="670" text-anchor="middle" class="label-small">‚Ä¢ Entrada: √Åudio PCM 16kHz</text>
    <text x="870" y="685" text-anchor="middle" class="label-small">‚Ä¢ Sa√≠da: √Åudio PCM 24kHz + Tool Calls</text>
    <text x="870" y="705" text-anchor="middle" class="label-small">‚Ä¢ Fun√ß√£o: Conversa em tempo real</text>

    <!-- Tools Legend -->
    <rect x="1040" y="610" width="280" height="110" rx="5" fill="#fff3e0" stroke="#ff6f00" stroke-width="1.5" />
    <text x="1180" y="635" text-anchor="middle" font-weight="bold" fill="#ff6f00">Ferramentas (tools.go)</text>
    <text x="1180" y="655" text-anchor="middle" class="label-small">‚Ä¢ alert_family: Push FCM + DB</text>
    <text x="1180" y="670" text-anchor="middle" class="label-small">‚Ä¢ confirm_medication: Update DB</text>
    <text x="1180" y="685" text-anchor="middle" class="label-small">‚Ä¢ schedule_appointment: Insert DB</text>
    <text x="1180" y="705" text-anchor="middle" class="label-small">‚Ä¢ Execu√ß√£o: Backend Go (n√£o o modelo)</text>

    <!-- Model Y Legend -->
    <rect x="730" y="740" width="280" height="110" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="1.5" />
    <text x="870" y="765" text-anchor="middle" font-weight="bold" fill="#e65100">Modelo Y - Anal√≠tico</text>
    <text x="870" y="785" text-anchor="middle" class="label-small">‚Ä¢ HTTP REST (generateContent)</text>
    <text x="870" y="800" text-anchor="middle" class="label-small">‚Ä¢ Entrada: Texto (transcri√ß√£o)</text>
    <text x="870" y="815" text-anchor="middle" class="label-small">‚Ä¢ Sa√≠da: JSON (ConversationAnalysis)</text>
    <text x="870" y="835" text-anchor="middle" class="label-small">‚Ä¢ Fun√ß√£o: "M√©dico observador" silencioso</text>

    <!-- Key Insight -->
    <rect x="1040" y="740" width="280" height="110" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5" />
    <text x="1180" y="765" text-anchor="middle" font-weight="bold" fill="#2e7d32">Insight Chave</text>
    <text x="1180" y="790" text-anchor="middle" class="label-small">Modelo X: Conversa natural e emp√°tica</text>
    <text x="1180" y="810" text-anchor="middle" class="label-small">Modelo Y: An√°lise cl√≠nica profunda</text>
    <text x="1180" y="830" text-anchor="middle" class="label-small">Backend Go: Orquestra ambos + DB</text>

    <!-- FLOW INDICATORS -->
    <text x="700" y="920" text-anchor="middle" class="label" fill="#1976d2">‚îÅ‚îÅ‚îÅ Fluxo de √Åudio em Tempo Real</text>
    <text x="700" y="945" text-anchor="middle" class="label" fill="#ff6f00">- - - - Execu√ß√£o de Ferramentas</text>
    <text x="1100" y="920" text-anchor="middle" class="label" fill="#7b1fa2">‚îÅ‚îÅ‚îÅ An√°lise P√≥s-Processamento</text>
    <text x="1100" y="945" text-anchor="middle" class="label" fill="#388e3c">‚îÅ‚îÅ‚îÅ Persist√™ncia de Dados</text>

    <!-- Bottom Note -->
    <text x="700" y="1000" text-anchor="middle" class="label" font-style="italic">
        O Modelo X nunca acessa o banco diretamente - Ele pede ao Backend Go para executar a√ß√µes
    </text>
    <text x="700" y="1020" text-anchor="middle" class="label" font-style="italic">
        O Modelo Y nunca fala com o idoso - Ele apenas analisa transcri√ß√µes e gera relat√≥rios cl√≠nicos
    </text>

</svg>